-- GigaChad Spy by Delta Executor
-- Modern Hardcore Mobile GUI Remote Spy

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TextService = game:GetService("TextService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")

local localPlayer = Players.LocalPlayer
local mouse = localPlayer:GetMouse()

-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
local MAX_LOGS = 200
local AUTO_BLOCK_THRESHOLD = 3
local REFIRE_DELAY = 0.1

-- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ (—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞ —Å –∞–∫—Ü–µ–Ω—Ç–∞–º–∏)
local COLORS = {
    BACKGROUND = Color3.fromRGB(15, 15, 20),
    SECONDARY = Color3.fromRGB(25, 25, 35),
    ACCENT = Color3.fromRGB(45, 45, 60),
    PRIMARY = Color3.fromRGB(0, 150, 255),
    SUCCESS = Color3.fromRGB(0, 200, 100),
    ERROR = Color3.fromRGB(255, 60, 60),
    WARNING = Color3.fromRGB(255, 180, 0),
    TEXT = Color3.fromRGB(240, 240, 240),
    TEXT_SECONDARY = Color3.fromRGB(180, 180, 180),
    
    -- –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–µ–º–æ–≤
    EVENT_OUT = Color3.fromRGB(255, 200, 0),
    EVENT_IN = Color3.fromRGB(200, 150, 0),
    FUNCTION_OUT = Color3.fromRGB(160, 0, 255),
    FUNCTION_IN = Color3.fromRGB(120, 0, 200),
    
    -- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã
    GLOW = Color3.fromRGB(0, 100, 255),
    NEON = Color3.fromRGB(0, 255, 255)
}

-- –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
local spyData = {
    logs = {},
    blockedRemotes = {},
    autoBlockCount = {},
    selectedLog = nil
}

-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
local function safeCall(func, errorMessage, ...)
    local success, result = pcall(func, ...)
    if not success then
        warn("üîß GigaChad Spy Error: " .. errorMessage .. " - " .. tostring(result))
        return nil
    end
    return result
end

-- –ê–Ω–∏–º–∞—Ü–∏–∏
local function tweenObject(object, properties, duration)
    safeCall(function()
        local tweenInfo = TweenInfo.new(duration or 0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(object, tweenInfo, properties)
        tween:Play()
        return tween
    end, "tweenObject failed")
end

-- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
local function createModernFrame(name, size, position, parent, color)
    return safeCall(function()
        local frame = Instance.new("Frame")
        frame.Name = name
        frame.Size = size
        frame.Position = position
        frame.BackgroundColor3 = color or COLORS.SECONDARY
        frame.BorderSizePixel = 0
        
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 12)
        corner.Parent = frame
        
        local stroke = Instance.new("UIStroke")
        stroke.Color = COLORS.ACCENT
        stroke.Thickness = 1
        stroke.Parent = frame
        
        if parent then
            frame.Parent = parent
        end
        
        return frame
    end, "createModernFrame failed: " .. name)
end

local function createModernButton(name, size, position, parent, text, color)
    return safeCall(function()
        local button = Instance.new("TextButton")
        button.Name = name
        button.Size = size
        button.Position = position
        button.BackgroundColor3 = color or COLORS.PRIMARY
        button.Text = "<b>" .. text .. "</b>"
        button.TextColor3 = COLORS.TEXT
        button.TextScaled = true
        button.RichText = true
        button.Font = Enum.Font.Cartoon
        button.BorderSizePixel = 0
        button.AutoButtonColor = false
        
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 8)
        corner.Parent = button
        
        local stroke = Instance.new("UIStroke")
        stroke.Color = COLORS.GLOW
        stroke.Thickness = 1
        stroke.Parent = button
        
        -- –ê–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        local originalColor = button.BackgroundColor3
        button.MouseEnter:Connect(function()
            tweenObject(button, {BackgroundColor3 = originalColor:Lerp(COLORS.NEON, 0.3)}, 0.1)
        end)
        
        button.MouseLeave:Connect(function()
            tweenObject(button, {BackgroundColor3 = originalColor}, 0.1)
        end)
        
        button.MouseButton1Down:Connect(function()
            tweenObject(button, {BackgroundTransparency = 0.3}, 0.05)
        end)
        
        button.MouseButton1Up:Connect(function()
            tweenObject(button, {BackgroundTransparency = 0}, 0.1)
        end)
        
        if parent then
            button.Parent = parent
        end
        
        return button
    end, "createModernButton failed: " .. name)
end

local function createModernLabel(name, size, position, parent, text, textSize)
    return safeCall(function()
        local label = Instance.new("TextLabel")
        label.Name = name
        label.Size = size
        label.Position = position
        label.BackgroundTransparency = 1
        label.Text = text
        label.TextColor3 = COLORS.TEXT
        label.TextScaled = not textSize
        label.TextSize = textSize or 14
        label.RichText = true
        label.Font = Enum.Font.Cartoon
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.TextWrapped = true
        
        if parent then
            label.Parent = parent
        end
        
        return label
    end, "createModernLabel failed: " .. name)
end

-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
local function valueToString(value, depth)
    depth = depth or 0
    if depth > 2 then return "..." end
    
    return safeCall(function()
        local valueType = typeof(value)
        
        if valueType == "table" then
            local parts = {}
            for k, v in pairs(value) do
                if #parts < 10 then -- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
                    table.insert(parts, string.format("[%s] = %s", valueToString(k, depth + 1), valueToString(v, depth + 1)))
                else
                    table.insert(parts, "...")
                    break
                end
            end
            return "{" .. table.concat(parts, ", ") .. "}"
        elseif valueType == "string" then
            if #value > 100 then
                return string.format("%q...", string.sub(value, 1, 100))
            end
            return string.format("%q", value)
        elseif valueType == "number" then
            return tostring(value)
        elseif valueType == "boolean" then
            return tostring(value)
        elseif valueType == "Vector3" then
            return string.format("Vector3.new(%.2f, %.2f, %.2f)", value.X, value.Y, value.Z)
        elseif valueType == "CFrame" then
            local x, y, z = value.Position.X, value.Position.Y, value.Position.Z
            return string.format("CFrame.new(%.2f, %.2f, %.2f)", x, y, z)
        elseif valueType == "Color3" then
            return string.format("Color3.new(%.2f, %.2f, %.2f)", value.R, value.G, value.B)
        elseif valueType == "Instance" then
            if value:IsA("Player") then
                return string.format('game:GetService("Players"):WaitForChild("%s")', value.Name)
            else
                return string.format('game:GetService("%s"):WaitForChild("%s")', value.ClassName, value.Name)
            end
        elseif valueType == "nil" then
            return "nil"
        elseif valueType == "buffer" then
            return "--[[ Buffer ]]"
        else
            return string.format("--[[ %s ]]", valueType)
        end
    end, "valueToString failed") or "--[[ Error ]]"
end

local function generateCode(remoteData)
    if not remoteData then return "-- Select a remote to view code --" end
    
    return safeCall(function()
        local argsString = ""
        if #remoteData.args > 0 then
            local argStrings = {}
            for i, arg in ipairs(remoteData.args) do
                table.insert(argStrings, string.format("    [%d] = %s", i, valueToString(arg)))
            end
            argsString = "local giga = {\n" .. table.concat(argStrings, ",\n") .. "\n}"
        else
            argsString = "local giga = {}"
        end

        local callString = ""
        if remoteData.isFunction then
            if remoteData.direction == "out" then
                callString = string.format("%s:InvokeServer(unpack(giga))", remoteData.remotePath)
            else
                callString = string.format("-- Incoming function: %s", remoteData.remotePath)
            end
        else
            if remoteData.direction == "out" then
                callString = string.format("%s:FireServer(unpack(giga))", remoteData.remotePath)
            else
                callString = string.format("-- Incoming event: %s", remoteData.remotePath)
            end
        end

        return argsString .. "\n" .. callString
    end, "generateCode failed") or "-- Error generating code --"
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ GUI
local function createMainGUI()
    return safeCall(function()
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "GigaChadSpy"
        screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        screenGui.ResetOnSpawn = false
        
        -- –ü–æ–º–µ—â–∞–µ–º –≤ CoreGui –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        screenGui.Parent = CoreGui

        -- –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞
        local floatButton = createModernButton(
            "FloatButton", 
            UDim2.new(0, 70, 0, 70),
            UDim2.new(0, 20, 0.5, -35),
            screenGui,
            "üöÄ\nGCS",
            COLORS.PRIMARY
        )
        floatButton.Visible = true

        -- –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ
        local mainFrame = createModernFrame(
            "MainFrame",
            UDim2.new(0.95, 0, 0.9, 0),
            UDim2.new(0.025, 0, 0.05, 0),
            screenGui,
            COLORS.BACKGROUND
        )
        mainFrame.Visible = false

        -- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
        local titleBar = createModernFrame(
            "TitleBar",
            UDim2.new(1, 0, 0, 60),
            UDim2.new(0, 0, 0, 0),
            mainFrame,
            COLORS.SECONDARY
        )

        local titleLabel = createModernLabel(
            "TitleLabel",
            UDim2.new(0.7, 0, 1, 0),
            UDim2.new(0, 15, 0, 0),
            titleBar,
            "<b>üî• GIGACHAD SPY</b>",
            20
        )

        local closeButton = createModernButton(
            "CloseButton",
            UDim2.new(0, 50, 0, 50),
            UDim2.new(1, -60, 0.5, -25),
            titleBar,
            "‚úï",
            COLORS.ERROR
        )

        -- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        local contentFrame = createModernFrame(
            "ContentFrame",
            UDim2.new(1, -20, 1, -80),
            UDim2.new(0, 10, 0, 70),
            mainFrame,
            COLORS.BACKGROUND
        )
        contentFrame.BackgroundTransparency = 1

        -- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - —Å–ø–∏—Å–æ–∫ —Ä–µ–º–æ–≤
        local leftPanel = createModernFrame(
            "LeftPanel",
            UDim2.new(0.4, 0, 1, 0),
            UDim2.new(0, 0, 0, 0),
            contentFrame,
            COLORS.SECONDARY
        )

        local remotesHeader = createModernFrame(
            "RemotesHeader",
            UDim2.new(1, 0, 0, 40),
            UDim2.new(0, 0, 0, 0),
            leftPanel,
            COLORS.ACCENT
        )

        createModernLabel(
            "RemotesTitle",
            UDim2.new(1, -10, 1, 0),
            UDim2.new(0, 10, 0, 0),
            remotesHeader,
            "<b>üì° ACTIVE REMOTES</b>",
            16
        )

        local remotesList = Instance.new("ScrollingFrame")
        remotesList.Name = "RemotesList"
        remotesList.Size = UDim2.new(1, 0, 1, -90)
        remotesList.Position = UDim2.new(0, 0, 0, 45)
        remotesList.BackgroundColor3 = COLORS.SECONDARY
        remotesList.BackgroundTransparency = 1
        remotesList.ScrollBarThickness = 4
        remotesList.ScrollBarImageColor3 = COLORS.PRIMARY
        remotesList.Parent = leftPanel

        local listLayout = Instance.new("UIListLayout")
        listLayout.Padding = UDim.new(0, 8)
        listLayout.Parent = remotesList

        -- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –∫–æ–¥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        local rightPanel = createModernFrame(
            "RightPanel",
            UDim2.new(0.58, 0, 1, 0),
            UDim2.new(0.42, 0, 0, 0),
            contentFrame,
            COLORS.SECONDARY
        )

        local codeHeader = createModernFrame(
            "CodeHeader",
            UDim2.new(1, 0, 0, 40),
            UDim2.new(0, 0, 0, 0),
            rightPanel,
            COLORS.ACCENT
        )

        createModernLabel(
            "CodeTitle",
            UDim2.new(1, -10, 1, 0),
            UDim2.new(0, 10, 0, 0),
            codeHeader,
            "<b>üíª GENERATED CODE</b>",
            16
        )

        local codeBox = Instance.new("ScrollingFrame")
        codeBox.Name = "CodeBox"
        codeBox.Size = UDim2.new(1, -10, 0.55, -10)
        codeBox.Position = UDim2.new(0, 5, 0, 45)
        codeBox.BackgroundColor3 = COLORS.BACKGROUND
        codeBox.ScrollBarThickness = 4
        codeBox.ScrollBarImageColor3 = COLORS.PRIMARY
        codeBox.Parent = rightPanel

        local codeCorner = Instance.new("UICorner")
        codeCorner.CornerRadius = UDim.new(0, 8)
        codeCorner.Parent = codeBox

        local codeStroke = Instance.new("UIStroke")
        codeStroke.Color = COLORS.ACCENT
        codeStroke.Thickness = 1
        codeStroke.Parent = codeBox

        local codeText = createModernLabel(
            "CodeText",
            UDim2.new(1, -20, 1, -20),
            UDim2.new(0, 10, 0, 10),
            codeBox,
            "-- Select a remote to view code --",
            14
        )
        codeText.TextYAlignment = Enum.TextYAlignment.Top
        codeText.TextXAlignment = Enum.TextXAlignment.Left

        -- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        local controlPanel = createModernFrame(
            "ControlPanel",
            UDim2.new(1, -10, 0.4, -10),
            UDim2.new(0, 5, 0.55, 5),
            rightPanel,
            COLORS.ACCENT
        )

        local controlGrid = Instance.new("UIGridLayout")
        controlGrid.CellSize = UDim2.new(0.5, -10, 0.33, -10)
        controlGrid.CellPadding = UDim2.new(0, 8, 0, 8)
        controlGrid.Parent = controlPanel

        -- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        local controlButtons = {
            {Name = "ReFire", Text = "üî•\nREFIRE", Color = COLORS.SUCCESS},
            {Name = "Copy", Text = "üìã\nCOPY", Color = COLORS.PRIMARY},
            {Name = "Block", Text = "üö´\nBLOCK", Color = COLORS.ERROR},
            {Name = "Source", Text = "üîç\nSOURCE", Color = COLORS.WARNING},
            {Name = "Clear", Text = "üóëÔ∏è\nCLEAR", Color = COLORS.ACCENT},
            {Name = "UnblockAll", Text = "üîì\nUNBLOCK", Color = COLORS.SUCCESS}
        }

        for _, btnInfo in pairs(controlButtons) do
            createModernButton(
                btnInfo.Name,
                UDim2.new(1, 0, 1, 0),
                UDim2.new(0, 0, 0, 0),
                controlPanel,
                btnInfo.Text,
                btnInfo.Color
            )
        end

        -- –°—Ç–∞—Ç—É—Å –±–∞—Ä
        local statusBar = createModernFrame(
            "StatusBar",
            UDim2.new(1, 0, 0, 30),
            UDim2.new(0, 0, 1, -30),
            leftPanel,
            COLORS.ACCENT
        )

        local statusLabel = createModernLabel(
            "StatusLabel",
            UDim2.new(1, -10, 1, 0),
            UDim2.new(0, 10, 0, 0),
            statusBar,
            "üìä Logs: 0 | Blocked: 0",
            12
        )

        return {
            ScreenGui = screenGui,
            MainFrame = mainFrame,
            FloatButton = floatButton,
            CloseButton = closeButton,
            RemotesList = remotesList,
            CodeText = codeText,
            ControlPanel = controlPanel,
            StatusLabel = statusLabel
        }
    end, "createMainGUI failed")
end

-- –•—É–∫–∏ –¥–ª—è Remote Events/Functions
local function hookRemoteEvent(remoteEvent)
    return safeCall(function()
        local oldFireServer = remoteEvent.FireServer
        
        remoteEvent.FireServer = function(self, ...)
            local args = {...}
            local remotePath = self:GetFullName()
            
            if not spyData.blockedRemotes[remotePath] then
                local logEntry = {
                    remote = self,
                    remotePath = remotePath,
                    args = args,
                    isFunction = false,
                    direction = "out",
                    timestamp = tick(),
                    callId = HttpService:GenerateGUID(false)
                }
                
                table.insert(spyData.logs, 1, logEntry)
                
                -- –ê–≤—Ç–æ-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
                spyData.autoBlockCount[remotePath] = (spyData.autoBlockCount[remotePath] or 0) + 1
                if spyData.autoBlockCount[remotePath] >= AUTO_BLOCK_THRESHOLD then
                    spyData.blockedRemotes[remotePath] = true
                end
                
                -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤
                if #spyData.logs > MAX_LOGS then
                    table.remove(spyData.logs, #spyData.logs)
                end
            end
            
            return oldFireServer(self, ...)
        end
        
        return true
    end, "hookRemoteEvent failed") or false
end

local function hookRemoteFunction(remoteFunction)
    return safeCall(function()
        local oldInvokeServer = remoteFunction.InvokeServer
        
        remoteFunction.InvokeServer = function(self, ...)
            local args = {...}
            local remotePath = self:GetFullName()
            
            if not spyData.blockedRemotes[remotePath] then
                local logEntry = {
                    remote = self,
                    remotePath = remotePath,
                    args = args,
                    isFunction = true,
                    direction = "out",
                    timestamp = tick(),
                    callId = HttpService:GenerateGUID(false)
                }
                
                table.insert(spyData.logs, 1, logEntry)
                
                -- –ê–≤—Ç–æ-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
                spyData.autoBlockCount[remotePath] = (spyData.autoBlockCount[remotePath] or 0) + 1
                if spyData.autoBlockCount[remotePath] >= AUTO_BLOCK_THRESHOLD then
                    spyData.blockedRemotes[remotePath] = true
                end
                
                if #spyData.logs > MAX_LOGS then
                    table.remove(spyData.logs, #spyData.logs)
                end
            end
            
            return oldInvokeServer(self, ...)
        end
        
        return true
    end, "hookRemoteFunction failed") or false
end

-- –•—É–∫ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
local function hookIncomingEvents()
    return safeCall(function()
        local function hookRemote(remote)
            if remote:IsA("RemoteEvent") then
                local connection
                connection = remote.OnClientEvent:Connect(function(...)
                    local args = {...}
                    local remotePath = remote:GetFullName()
                    
                    if not spyData.blockedRemotes[remotePath] then
                        local logEntry = {
                            remote = remote,
                            remotePath = remotePath,
                            args = args,
                            isFunction = false,
                            direction = "in",
                            timestamp = tick(),
                            callId = HttpService:GenerateGUID(false)
                        }
                        
                        table.insert(spyData.logs, 1, logEntry)
                        
                        if #spyData.logs > MAX_LOGS then
                            table.remove(spyData.logs, #spyData.logs)
                        end
                    end
                end)
            elseif remote:IsA("RemoteFunction") then
                local oldOnClientInvoke = remote.OnClientInvoke
                remote.OnClientInvoke = function(...)
                    local args = {...}
                    local remotePath = remote:GetFullName()
                    
                    if not spyData.blockedRemotes[remotePath] then
                        local logEntry = {
                            remote = remote,
                            remotePath = remotePath,
                            args = args,
                            isFunction = true,
                            direction = "in",
                            timestamp = tick(),
                            callId = HttpService:GenerateGUID(false)
                        }
                        
                        table.insert(spyData.logs, 1, logEntry)
                        
                        if #spyData.logs > MAX_LOGS then
                            table.remove(spyData.logs, #spyData.logs)
                        end
                    end
                    
                    if oldOnClientInvoke then
                        return oldOnClientInvoke(...)
                    end
                    return nil
                end
            end
        end

        -- –•—É–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ–º–æ–≤
        local function processInstance(instance)
            if instance:IsA("RemoteEvent") or instance:IsA("RemoteFunction") then
                hookRemote(instance)
            end
            
            for _, child in pairs(instance:GetChildren()) do
                processInstance(child)
            end
        end
        
        processInstance(game)
        
        -- –•—É–∫ –Ω–æ–≤—ã—Ö —Ä–µ–º–æ–≤
        game.DescendantAdded:Connect(function(descendant)
            if descendant:IsA("RemoteEvent") or descendant:IsA("RemoteFunction") then
                hookRemote(descendant)
            end
        end)
        
        return true
    end, "hookIncomingEvents failed") or false
end

-- –ü–æ–∏—Å–∫ –∏ —Ö—É–∫ –≤—Å–µ—Ö —Ä–µ–º–æ–≤
local function findAndHookRemotes()
    return safeCall(function()
        local hookedCount = 0
        
        local function processInstance(instance)
            if instance:IsA("RemoteEvent") then
                if hookRemoteEvent(instance) then
                    hookedCount = hookedCount + 1
                end
            elseif instance:IsA("RemoteFunction") then
                if hookRemoteFunction(instance) then
                    hookedCount = hookedCount + 1
                end
            end
            
            for _, child in pairs(instance:GetChildren()) do
                processInstance(child)
            end
        end
        
        processInstance(game)
        
        -- –•—É–∫ –¥–ª—è –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        game.DescendantAdded:Connect(function(descendant)
            wait(0.1) -- –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            if descendant:IsA("RemoteEvent") then
                hookRemoteEvent(descendant)
            elseif descendant:IsA("RemoteFunction") then
                hookRemoteFunction(descendant)
            end
        end)
        
        return hookedCount
    end, "findAndHookRemotes failed") or 0
end

-- –§—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π
local function refireRemote(remoteData)
    if not remoteData then return false, "No remote data" end
    
    return safeCall(function()
        local args = {}
        for i, arg in ipairs(remoteData.args) do
            args[i] = arg
        end
        
        if remoteData.isFunction then
            if remoteData.direction == "out" then
                return true, remoteData.remote:InvokeServer(unpack(args))
            else
                return false, "Cannot refire incoming function calls"
            end
        else
            if remoteData.direction == "out" then
                remoteData.remote:FireServer(unpack(args))
                return true, "Fired successfully"
            else
                return false, "Cannot refire incoming event calls"
            end
        end
    end, "refireRemote failed")
end

local function toggleBlockRemote(remotePath)
    return safeCall(function()
        if spyData.blockedRemotes[remotePath] then
            spyData.blockedRemotes[remotePath] = nil
            spyData.autoBlockCount[remotePath] = nil
            return false
        else
            spyData.blockedRemotes[remotePath] = true
            return true
        end
    end, "toggleBlockRemote failed") or false
end

local function decompileSource(remoteData)
    return safeCall(function()
        local sourceInfo = string.format("üì° Remote: %s\nüéØ Type: %s\nüì§ Direction: %s\n‚è∞ Time: %.3f\nüî¢ Args: %d",
            remoteData.remotePath,
            remoteData.isFunction and "Function" or "Event",
            remoteData.direction,
            remoteData.timestamp,
            #remoteData.args
        )
        
        return sourceInfo
    end, "decompileSource failed") or "‚ùå Error getting source information"
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GUI
local function updateGUI(guiElements)
    return safeCall(function()
        local remotesList = guiElements.RemotesList
        local codeText = guiElements.CodeText
        local controlPanel = guiElements.ControlPanel
        local statusLabel = guiElements.StatusLabel
        
        -- –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–∞
        for _, child in pairs(remotesList:GetChildren()) do
            if child:IsA("TextButton") then
                child:Destroy()
            end
        end

        -- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤
        for i, logEntry in ipairs(spyData.logs) do
            local remoteButton = createModernButton(
                "RemoteButton_" .. i,
                UDim2.new(1, -10, 0, 70),
                UDim2.new(0, 5, 0, (i-1)*78),
                remotesList,
                "",
                COLORS.BACKGROUND
            )
            
            -- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            local bgColor = logEntry.direction == "out" and 
                           (logEntry.isFunction and COLORS.FUNCTION_OUT or COLORS.EVENT_OUT) or
                           (logEntry.isFunction and COLORS.FUNCTION_IN or COLORS.EVENT_IN)
            
            remoteButton.BackgroundColor3 = bgColor
            
            -- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–º–æ–≤—Ç–µ
            local nameLabel = createModernLabel(
                "NameLabel",
                UDim2.new(0.8, 0, 0.5, 0),
                UDim2.new(0, 10, 0, 5),
                remoteButton,
                "üì° " .. logEntry.remotePath,
                12
            )
            nameLabel.TextYAlignment = Enum.TextYAlignment.Top
            
            local infoLabel = createModernLabel(
                "InfoLabel",
                UDim2.new(1, -10, 0.4, 0),
                UDim2.new(0, 10, 0.5, 0),
                remoteButton,
                string.format("üéØ %s | üì§ %s | üî¢ %d args", 
                    logEntry.isFunction and "FUNC" or "EVENT",
                    logEntry.direction:upper(),
                    #logEntry.args),
                10
            )
            infoLabel.TextColor3 = COLORS.TEXT_SECONDARY
            
            -- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            if spyData.blockedRemotes[logEntry.remotePath] then
                local blockIndicator = createModernFrame(
                    "BlockIndicator",
                    UDim2.new(0, 20, 0, 20),
                    UDim2.new(1, -25, 0, 5),
                    remoteButton,
                    COLORS.ERROR
                )
            end
            
            -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            remoteButton.MouseButton1Click:Connect(function()
                spyData.selectedLog = logEntry
                local code = generateCode(logEntry)
                codeText.Text = code
                
                -- –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                local blockButton = controlPanel:FindFirstChild("Block")
                if blockButton then
                    local isBlocked = spyData.blockedRemotes[logEntry.remotePath]
                    blockButton.Text = isBlocked and "üîì\nUNBLOCK" or "üö´\nBLOCK"
                    blockButton.BackgroundColor3 = isBlocked and COLORS.SUCCESS or COLORS.ERROR
                end
            end)
        end
        
        remotesList.CanvasSize = UDim2.new(0, 0, 0, #spyData.logs * 78)
        
        -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
        local blockedCount = 0
        for _ in pairs(spyData.blockedRemotes) do
            blockedCount = blockedCount + 1
        end
        statusLabel.Text = string.format("üìä Logs: %d | üö´ Blocked: %d", #spyData.logs, blockedCount)
        
        return true
    end, "updateGUI failed") or false
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
local function initializeSpy()
    print("üöÄ Initializing GigaChad Spy...")
    
    local guiElements = createMainGUI()
    if not guiElements then
        error("‚ùå Failed to create GUI elements")
    end
    
    -- –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ
    local function safeConnectButton(buttonName, callback)
        local button = guiElements.ControlPanel:FindFirstChild(buttonName)
        if button then
            button.MouseButton1Click:Connect(function()
                safeCall(callback, "Button callback failed: " .. buttonName)
            end)
        else
            warn("‚ö†Ô∏è Button not found: " .. buttonName)
        end
    end
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
    guiElements.FloatButton.MouseButton1Click:Connect(function()
        guiElements.MainFrame.Visible = not guiElements.MainFrame.Visible
        guiElements.FloatButton.Visible = not guiElements.MainFrame.Visible
    end)
    
    guiElements.CloseButton.MouseButton1Click:Connect(function()
        guiElements.MainFrame.Visible = false
        guiElements.FloatButton.Visible = true
    end)
    
    -- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    safeConnectButton("ReFire", function()
        if spyData.selectedLog then
            local success, result = refireRemote(spyData.selectedLog)
            if success then
                guiElements.CodeText.Text = generateCode(spyData.selectedLog) .. "\n\n‚úÖ Refire successful!"
                if result ~= nil and result ~= true then
                    guiElements.CodeText.Text = guiElements.CodeText.Text .. "\nüì§ Return: " .. valueToString(result)
                end
            else
                guiElements.CodeText.Text = generateCode(spyData.selectedLog) .. "\n\n‚ùå Refire failed: " .. tostring(result)
            end
        end
    end)
    
    safeConnectButton("Copy", function()
        if spyData.selectedLog then
            local code = generateCode(spyData.selectedLog)
            if setclipboard then
                setclipboard(code)
                guiElements.CodeText.Text = code .. "\n\n‚úÖ Copied to clipboard!"
            else
                guiElements.CodeText.Text = code .. "\n\n‚ùå Clipboard not available!"
            end
        end
    end)
    
    safeConnectButton("Block", function()
        if spyData.selectedLog then
            local isBlocked = toggleBlockRemote(spyData.selectedLog.remotePath)
            local blockButton = guiElements.ControlPanel:FindFirstChild("Block")
            if blockButton then
                blockButton.Text = isBlocked and "üîì\nUNBLOCK" or "üö´\nBLOCK"
                blockButton.BackgroundColor3 = isBlocked and COLORS.SUCCESS or COLORS.ERROR
            end
            guiElements.CodeText.Text = generateCode(spyData.selectedLog) .. 
                           (isBlocked and "\n\n‚úÖ Remote blocked!" or "\n\n‚úÖ Remote unblocked!")
        end
    end)
    
    safeConnectButton("Source", function()
        if spyData.selectedLog then
            local sourceInfo = decompileSource(spyData.selectedLog)
            guiElements.CodeText.Text = "üîç SOURCE INFORMATION\n" .. sourceInfo .. "\n\n" .. generateCode(spyData.selectedLog)
        end
    end)
    
    safeConnectButton("Clear", function()
        spyData.logs = {}
        spyData.selectedLog = nil
        guiElements.CodeText.Text = "-- Select a remote to view code --"
        updateGUI(guiElements)
    end)
    
    safeConnectButton("UnblockAll", function()
        spyData.blockedRemotes = {}
        spyData.autoBlockCount = {}
        if spyData.selectedLog then
            local blockButton = guiElements.ControlPanel:FindFirstChild("Block")
            if blockButton then
                blockButton.Text = "üö´\nBLOCK"
                blockButton.BackgroundColor3 = COLORS.ERROR
            end
        end
        guiElements.CodeText.Text = (spyData.selectedLog and generateCode(spyData.selectedLog) or "") .. "\n\n‚úÖ All blocks cleared!"
        updateGUI(guiElements)
    end)
    
    -- –•—É–∫ —Ä–µ–º–æ–≤
    local hookedCount = findAndHookRemotes()
    local incomingHooked = hookIncomingEvents()
    
    print(string.format("üéØ GigaChad Spy: Hooked %d remotes, Incoming events: %s", 
          hookedCount, tostring(incomingHooked)))
    
    -- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GUI
    local updateConnection
    updateConnection = RunService.Heartbeat:Connect(function()
        if guiElements.ScreenGui.Parent then
            updateGUI(guiElements)
        else
            updateConnection:Disconnect()
        end
    end)
    
    return guiElements.ScreenGui
end

-- –ó–∞–ø—É—Å–∫ spy
if not _G.GigaChadSpyLoaded then
    _G.GigaChadSpyLoaded = true
    local success, result = pcall(initializeSpy)
    if success then
        print("üéâ GigaChad Spy loaded successfully!")
    else
        warn("‚ùå GigaChad Spy failed to load: " .. tostring(result))
        _G.GigaChadSpyLoaded = false
    end
else
    print("‚ö†Ô∏è GigaChad Spy already loaded!")
end
